============================= test session starts =============================
platform win32 -- Python 3.10.18, pytest-8.4.2, pluggy-1.6.0 -- C:\Users\Oxidane\Documents\projects\New folder\.venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\Oxidane\Documents\projects\New folder
configfile: pyproject.toml
plugins: anyio-4.11.0, asyncio-1.2.0, mock-3.15.1, timeout-2.4.0
asyncio: mode=strict, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
timeout: 10.0s
timeout method: thread
timeout func_only: False
collecting ... collected 131 items / 40 deselected / 91 selected

tests/test_basic_functionality.py::test_basic_imports PASSED             [  1%]
tests/test_basic_functionality.py::test_di_container_creation PASSED     [  2%]
tests/test_basic_functionality.py::test_event_system PASSED              [  3%]
tests/test_basic_functionality.py::test_config_loading PASSED            [  4%]
tests/test_basic_functionality.py::test_audio_service_mock PASSED        [  5%]
tests/test_basic_functionality.py::test_whisper_service_mock PASSED      [  6%]
tests/test_basic_functionality.py::test_state_management PASSED          [  7%]
tests/test_basic_simple.py::test_di_container PASSED                     [  8%]
tests/test_basic_simple.py::test_event_constants PASSED                  [  9%]
tests/test_basic_simple.py::test_basic_mock_services PASSED              [ 10%]
tests/test_basic_simple.py::test_recording_states PASSED                 [ 12%]
tests/test_bug_regression.py::TestBugFixes::test_bug_second_recording_works PASSED [ 13%]
tests/test_bug_regression.py::TestBugFixes::test_bug_audio_level_type_is_float PASSED [ 14%]
tests/test_bug_regression.py::TestBugFixes::test_bug_overlay_displays_on_recording PASSED [ 15%]
tests/test_cloud_transcription_services.py::test_factory_create_local_service PASSED [ 16%]
tests/test_cloud_transcription_services.py::test_factory_create_groq_service PASSED [ 17%]
tests/test_cloud_transcription_services.py::test_factory_groq_requires_api_key PASSED [ 18%]
tests/test_cloud_transcription_services.py::test_factory_unsupported_provider PASSED [ 19%]
tests/test_cloud_transcription_services.py::test_factory_from_config_local PASSED [ 20%]
tests/test_cloud_transcription_services.py::test_factory_from_config_groq PASSED [ 21%]
tests/test_cloud_transcription_services.py::test_factory_from_config_no_api_key_fallback FAILED [ 23%]
tests/test_cloud_transcription_services.py::test_factory_local_fallback PASSED [ 24%]
tests/test_cloud_transcription_services.py::test_groq_service_initialization PASSED [ 25%]
tests/test_cloud_transcription_services.py::test_groq_available_models PASSED [ 26%]
tests/test_cloud_transcription_services.py::test_groq_load_model_success PASSED [ 27%]
tests/test_cloud_transcription_services.py::test_groq_load_model_no_api_key PASSED [ 28%]
tests/test_cloud_transcription_services.py::test_groq_load_model_invalid_model PASSED [ 29%]
tests/test_cloud_transcription_services.py::test_groq_transcribe_success PASSED [ 30%]
tests/test_cloud_transcription_services.py::test_groq_transcribe_auto_language PASSED [ 31%]
tests/test_cloud_transcription_services.py::test_groq_transcribe_api_error PASSED [ 32%]
tests/test_cloud_transcription_services.py::test_groq_transcribe_model_not_loaded PASSED [ 34%]
tests/test_cloud_transcription_services.py::test_groq_numpy_to_wav_conversion PASSED [ 35%]
tests/test_cloud_transcription_services.py::test_groq_numpy_to_wav_float_conversion PASSED [ 36%]
tests/test_cloud_transcription_services.py::test_groq_convert_segments_dict_format PASSED [ 37%]
tests/test_cloud_transcription_services.py::test_groq_convert_segments_object_format PASSED [ 38%]
tests/test_cloud_transcription_services.py::test_groq_convert_segments_no_segments PASSED [ 39%]
tests/test_cloud_transcription_services.py::test_groq_unload_model PASSED [ 40%]
tests/test_cloud_transcription_services.py::test_groq_is_model_loaded_property PASSED [ 41%]
tests/test_cloud_transcription_services.py::test_groq_on_demand_initialization PASSED [ 42%]
tests/test_cloud_transcription_services.py::test_groq_pre_initialization_vs_on_demand PASSED [ 43%]
tests/test_end_to_end_workflow.py::TestEndToEndWorkflow::test_complete_recording_to_input_workflow PASSED [ 45%]
tests/test_end_to_end_workflow.py::TestEndToEndWorkflow::test_streaming_recording_chunks PASSED [ 46%]
tests/test_end_to_end_workflow.py::TestEndToEndWorkflow::test_ai_optimization_integration PASSED [ 47%]
tests/test_end_to_end_workflow.py::TestEndToEndWorkflow::test_clipboard_input_workflow PASSED [ 48%]
tests/test_end_to_end_workflow.py::TestEndToEndWorkflow::test_error_handling_in_workflow PASSED [ 49%]
tests/test_end_to_end_workflow.py::TestEndToEndWorkflow::test_event_driven_workflow PASSED [ 50%]
tests/test_end_to_end_workflow.py::TestEndToEndWorkflow::test_performance_metrics_tracking PASSED [ 51%]
tests/test_event_listener_regression.py::test_event_listener_signatures PASSED [ 52%]
tests/test_event_listener_regression.py::test_dynamic_event_system_callback_compatibility PASSED [ 53%]
tests/test_event_listener_regression.py::test_voice_input_app_event_listeners PASSED [ 54%]
tests/test_event_listener_regression.py::test_event_system_integration PASSED [ 56%]
tests/test_real_recording_functionality.py::TestRealRecordingFunctionality::test_application_initialization PASSED [ 57%]
tests/test_real_recording_functionality.py::TestRealRecordingFunctionality::test_recording_state_flow PASSED [ 58%]
tests/test_real_recording_functionality.py::TestRealRecordingFunctionality::test_transcription_workflow PASSED [ 59%]
tests/test_real_recording_functionality.py::TestRealRecordingFunctionality::test_overlay_integration FAILED [ 60%]
tests/test_real_recording_functionality.py::TestRealRecordingFunctionality::test_error_handling PASSED [ 61%]
tests/test_real_recording_functionality.py::TestRealRecordingFunctionality::test_audio_level_updates FAILED [ 62%]
tests/test_real_recording_functionality.py::TestRealRecordingFunctionality::test_config_changes PASSED [ 63%]
tests/test_real_recording_functionality.py::TestRealRecordingFunctionality::test_hotkey_functionality PASSED [ 64%]
tests/test_real_recording_functionality.py::TestRealRecordingFunctionality::test_complete_workflow_integration PASSED [ 65%]
tests/test_recording_basic.py::TestRecordingBasic::test_recording_basic_workflow PASSED [ 67%]
tests/test_recording_basic.py::TestRecordingBasic::test_recording_state_transitions PASSED [ 68%]
tests/test_recording_basic.py::TestRecordingBasic::test_multiple_recording_cycles PASSED [ 69%]
tests/test_recording_basic.py::TestRecordingBasic::test_audio_level_events_during_recording PASSED [ 70%]
tests/test_recording_basic.py::TestRecordingBasic::test_recording_with_overlay_mock PASSED [ 71%]
tests/test_recording_basic.py::TestRecordingBasic::test_error_handling_during_recording PASSED [ 72%]
tests/test_recording_basic.py::TestRecordingBasic::test_complete_recording_workflow PASSED [ 73%]
tests/test_recording_simple.py::TestRecordingFunctionality::test_recording_start_stop_flow FAILED [ 74%]
tests/test_recording_simple.py::TestRecordingFunctionality::test_audio_data_collection FAILED [ 75%]
tests/test_recording_simple.py::TestRecordingFunctionality::test_recording_state_transitions PASSED [ 76%]
tests/test_recording_simple.py::TestRecordingFunctionality::test_audio_level_updates PASSED [ 78%]
tests/test_recording_simple.py::TestRecordingFunctionality::test_error_handling_in_recording PASSED [ 79%]
tests/test_recording_simple.py::TestRecordingFunctionality::test_multiple_recording_cycles FAILED [ 80%]
tests/test_recording_simple.py::TestRecordingFunctionality::test_recording_with_audio_device_selection PASSED [ 81%]
tests/test_refactoring_completeness.py::test_voice_input_app_uses_unified_api PASSED [ 82%]
tests/test_refactoring_completeness.py::test_model_reload_uses_reload_model PASSED [ 83%]
tests/test_refactoring_completeness.py::test_no_legacy_whisper_engine_access PASSED [ 84%]
tests/test_refactoring_completeness.py::test_refactoring_completeness PASSED [ 85%]
tests/test_streaming_transcription.py::TestTranscriptionServiceBasics::test_service_starts_and_stops FAILED [ 86%]
tests/test_streaming_transcription.py::TestTranscriptionServiceBasics::test_single_transcription PASSED [ 87%]
tests/test_streaming_transcription.py::TestTranscriptionServiceBasics::test_single_transcription ERROR [ 87%]
tests/test_streaming_transcription.py::TestTranscriptionServiceBasics::test_async_transcription FAILED [ 89%]
tests/test_streaming_transcription.py::TestTranscriptionServiceBasics::test_async_transcription ERROR [ 89%]
tests/test_streaming_transcription.py::TestStreamingTranscription::test_streaming_mode_basic FAILED [ 90%]
tests/test_streaming_transcription.py::TestStreamingTranscription::test_streaming_mode_basic ERROR [ 90%]
tests/test_streaming_transcription.py::TestStreamingTranscription::test_multiple_streaming_sessions FAILED [ 91%]
tests/test_streaming_transcription.py::TestStreamingTranscription::test_multiple_streaming_sessions ERROR [ 91%]
tests/test_streaming_transcription.py::TestStreamingTranscription::test_streaming_with_many_chunks FAILED [ 92%]
tests/test_streaming_transcription.py::TestStreamingTranscription::test_streaming_with_many_chunks ERROR [ 92%]
tests/test_streaming_transcription.py::TestStreamingTranscription::test_streaming_chunk_order FAILED [ 93%]
tests/test_streaming_transcription.py::TestStreamingTranscription::test_streaming_chunk_order ERROR [ 93%]
tests/test_streaming_transcription.py::TestGPUMemoryManagement::test_continuous_transcription_no_cuda_error PASSED [ 94%]
tests/test_streaming_transcription.py::TestGPUMemoryManagement::test_continuous_transcription_no_cuda_error ERROR [ 94%]
tests/test_streaming_transcription.py::TestGPUMemoryManagement::test_rapid_transcription_no_resource_leak FAILED [ 95%]
tests/test_streaming_transcription.py::TestGPUMemoryManagement::test_rapid_transcription_no_resource_leak ERROR [ 95%]
tests/test_streaming_transcription.py::TestErrorHandling::test_transcription_error_recovery FAILED [ 96%]
tests/test_streaming_transcription.py::TestErrorHandling::test_streaming_with_failed_chunks FAILED [ 97%]
tests/test_streaming_transcription.py::TestErrorHandling::test_streaming_with_failed_chunks ERROR [ 97%]
tests/test_streaming_transcription.py::TestPerformance::test_streaming_reduces_latency FAILED [ 98%]
tests/test_streaming_transcription.py::TestPerformance::test_streaming_reduces_latency ERROR [ 98%]
tests/test_streaming_transcription.py::TestIntegration::test_realistic_voice_input_workflow FAILED [100%]
tests/test_streaming_transcription.py::TestIntegration::test_realistic_voice_input_workflow ERROR [100%]

=================================== ERRORS ====================================
_ ERROR at teardown of TestTranscriptionServiceBasics.test_single_transcription _
tests\test_streaming_transcription.py:69: in transcription_service
    service.stop(timeout=2.0)
E   TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
---------------------------- Captured stdout setup ----------------------------
[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744494235888'>\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744494235888'> | device: <MagicMock name='mock().device' id='1744494446960'> | load_time: 0.0\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
---------------------------- Captured stdout call -----------------------------
[08:31:35] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 2.0 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744494600752'> | text_length: 0
_ ERROR at teardown of TestTranscriptionServiceBasics.test_async_transcription _
tests\test_streaming_transcription.py:69: in transcription_service
    service.stop(timeout=2.0)
E   TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
---------------------------- Captured stdout setup ----------------------------
[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744494995984'>\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744494995984'> | device: <MagicMock name='mock().device' id='1744495059552'> | load_time: 0.0\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
---------------------------- Captured stdout call -----------------------------
[08:31:35] [32mINFO[0m | audio | Audio: Task submitted
  task_id: 7ac96612-f353-48ee-9d05-c7231ba60785 | task_type: transcribe | priority: NORMAL | queue_size: 1
[08:31:35] [32mINFO[0m | audio | Audio: Task execution started
  task_id: 7ac96612-f353-48ee-9d05-c7231ba60785 | task_type: transcribe
[08:31:35] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 2.0 | processing_time: 0.0004994869232177734 | language: <MagicMock name='mock().transcribe().get()' id='1744495263552'> | text_length: 0
[08:31:35] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: 7ac96612-f353-48ee-9d05-c7231ba60785 | execution_time: 0.0035009384155273438
__ ERROR at teardown of TestStreamingTranscription.test_streaming_mode_basic __
tests\test_streaming_transcription.py:69: in transcription_service
    service.stop(timeout=2.0)
E   TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
---------------------------- Captured stdout setup ----------------------------
[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744495668688'>\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744495668688'> | device: <MagicMock name='mock().device' id='1744495486496'> | load_time: 0.0\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
_ ERROR at teardown of TestStreamingTranscription.test_multiple_streaming_sessions _
tests\test_streaming_transcription.py:69: in transcription_service
    service.stop(timeout=2.0)
E   TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
---------------------------- Captured stdout setup ----------------------------
[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744495725488'>\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744495725488'> | device: <MagicMock name='mock().device' id='1744495789056'> | load_time: 0.0\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
_ ERROR at teardown of TestStreamingTranscription.test_streaming_with_many_chunks _
tests\test_streaming_transcription.py:69: in transcription_service
    service.stop(timeout=2.0)
E   TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
---------------------------- Captured stdout setup ----------------------------
[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744496132640'>\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744496132640'> | device: <MagicMock name='mock().device' id='1744496288160'> | load_time: 0.0004990100860595703\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
_ ERROR at teardown of TestStreamingTranscription.test_streaming_chunk_order __
tests\test_streaming_transcription.py:69: in transcription_service
    service.stop(timeout=2.0)
E   TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
---------------------------- Captured stdout setup ----------------------------
[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744492061232'>\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744492061232'> | device: <MagicMock name='mock().device' id='1744492600800'> | load_time: 0.0005004405975341797\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
_ ERROR at teardown of TestGPUMemoryManagement.test_continuous_transcription_no_cuda_error _
tests\test_streaming_transcription.py:69: in transcription_service
    service.stop(timeout=2.0)
E   TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
---------------------------- Captured stdout setup ----------------------------
[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744496393952'>\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744496393952'> | device: <MagicMock name='mock().device' id='1744496557072'> | load_time: 0.0004916191101074219\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
---------------------------- Captured stdout call -----------------------------
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 1.0 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744496702224'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 1.0 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744496702224'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 1.0 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744496702224'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 1.0 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744496702224'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 1.0 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744496702224'> | text_length: 0
_ ERROR at teardown of TestGPUMemoryManagement.test_rapid_transcription_no_resource_leak _
tests\test_streaming_transcription.py:69: in transcription_service
    service.stop(timeout=2.0)
E   TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
---------------------------- Captured stdout setup ----------------------------
[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744513598704'>\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744513598704'> | device: <MagicMock name='mock().device' id='1744513539648'> | load_time: 0.0\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
---------------------------- Captured stdout call -----------------------------
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: 3ddc062c-1ddd-4f52-80d0-9d5a58e2ec86 | task_type: transcribe | priority: NORMAL | queue_size: 1
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: 3ddc062c-1ddd-4f52-80d0-9d5a58e2ec86 | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: 0d177c16-d699-4a51-ae75-d184d9648549 | task_type: transcribe | priority: NORMAL | queue_size: 1
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: 82ff30dc-18ea-4dc2-960e-6e1d98c349f3 | task_type: transcribe | priority: NORMAL | queue_size: 2
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: 3ddc062c-1ddd-4f52-80d0-9d5a58e2ec86 | execution_time: 0.0024995803833007812
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: b5332735-669f-493d-97ba-f802c32a2cd7 | task_type: transcribe | priority: NORMAL | queue_size: 3
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: 0d177c16-d699-4a51-ae75-d184d9648549 | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: 808f55ca-5782-4973-9780-733b9c346712 | task_type: transcribe | priority: NORMAL | queue_size: 3
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: b8ccea76-069b-4d1c-bfa3-ef6f4f247b97 | task_type: transcribe | priority: NORMAL | queue_size: 4
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: 0d177c16-d699-4a51-ae75-d184d9648549 | execution_time: 0.0014948844909667969
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: 65365da8-5085-4b4c-9009-cdbd70f8ed5a | task_type: transcribe | priority: NORMAL | queue_size: 5
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: 82ff30dc-18ea-4dc2-960e-6e1d98c349f3 | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: 2f0f978f-5e36-4da1-805c-ac6399a48165 | task_type: transcribe | priority: NORMAL | queue_size: 5
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: 86e7e88c-961b-418d-8409-3ee238e8c62b | task_type: transcribe | priority: NORMAL | queue_size: 6
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: 82ff30dc-18ea-4dc2-960e-6e1d98c349f3 | execution_time: 0.0015017986297607422
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: 4b28ed20-fd73-4f90-8b88-04cd4677f2a0 | task_type: transcribe | priority: NORMAL | queue_size: 7
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: b5332735-669f-493d-97ba-f802c32a2cd7 | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: b5332735-669f-493d-97ba-f802c32a2cd7 | execution_time: 0.0010004043579101562
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: 808f55ca-5782-4973-9780-733b9c346712 | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: 808f55ca-5782-4973-9780-733b9c346712 | execution_time: 0.00099945068359375
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: b8ccea76-069b-4d1c-bfa3-ef6f4f247b97 | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: b8ccea76-069b-4d1c-bfa3-ef6f4f247b97 | execution_time: 0.0005021095275878906
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: 65365da8-5085-4b4c-9009-cdbd70f8ed5a | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: 65365da8-5085-4b4c-9009-cdbd70f8ed5a | execution_time: 0.0010046958923339844
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: 2f0f978f-5e36-4da1-805c-ac6399a48165 | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: 2f0f978f-5e36-4da1-805c-ac6399a48165 | execution_time: 0.0010154247283935547
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: 86e7e88c-961b-418d-8409-3ee238e8c62b | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: 86e7e88c-961b-418d-8409-3ee238e8c62b | execution_time: 0.0009989738464355469
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: 4b28ed20-fd73-4f90-8b88-04cd4677f2a0 | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: 4b28ed20-fd73-4f90-8b88-04cd4677f2a0 | execution_time: 0.0004982948303222656
__ ERROR at teardown of TestErrorHandling.test_streaming_with_failed_chunks ___
tests\test_streaming_transcription.py:69: in transcription_service
    service.stop(timeout=2.0)
E   TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
---------------------------- Captured stdout setup ----------------------------
[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744514846816'>\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744514846816'> | device: <MagicMock name='mock().device' id='1744514959440'> | load_time: 0.0005011558532714844\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
_____ ERROR at teardown of TestPerformance.test_streaming_reduces_latency _____
tests\test_streaming_transcription.py:69: in transcription_service
    service.stop(timeout=2.0)
E   TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
---------------------------- Captured stdout setup ----------------------------
[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744515331264'>\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744515331264'> | device: <MagicMock name='mock().device' id='1744515427600'> | load_time: 0.0005054473876953125\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
__ ERROR at teardown of TestIntegration.test_realistic_voice_input_workflow ___
tests\test_streaming_transcription.py:69: in transcription_service
    service.stop(timeout=2.0)
E   TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
---------------------------- Captured stdout setup ----------------------------
[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744515650208'>\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744515650208'> | device: <MagicMock name='mock().device' id='1744515535616'> | load_time: 0.0\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
================================== FAILURES ===================================
________________ test_factory_from_config_no_api_key_fallback _________________
tests\test_cloud_transcription_services.py:178: in test_factory_from_config_no_api_key_fallback
    assert service is not None
E   assert None is not None
---------------------------- Captured stdout call -----------------------------
[08:30:59] [32mINFO[0m | audio | Audio: Groq provider selected but no API key configured
[08:30:59] [32mINFO[0m | audio | Audio: Cannot fallback: faster-whisper not installed
  suggestion: Install with: uv sync --extra local --extra dev
___________ TestRealRecordingFunctionality.test_overlay_integration ___________
tests\test_real_recording_functionality.py:175: in test_overlay_integration
    assert real_app._validate_overlay_state() == True
E   AttributeError: 'VoiceInputApp' object has no attribute '_validate_overlay_state'
---------------------------- Captured stdout setup ----------------------------
[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: recording_started | namespace: audio | description: \u5f55\u97f3\u5f00\u59cb\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: recording_stopped | namespace: audio | description: \u5f55\u97f3\u505c\u6b62\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: recording_error | namespace: audio | description: \u5f55\u97f3\u9519\u8bef\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: audio_level_update | namespace: audio | description: \u97f3\u9891\u7535\u5e73\u66f4\u65b0\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: transcription_started | namespace: speech | description: \u8f6c\u5f55\u5f00\u59cb\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: transcription_completed | namespace: speech | description: \u8f6c\u5f55\u5b8c\u6210\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: transcription_error | namespace: speech | description: \u8f6c\u5f55\u9519\u8bef\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_loading_started | namespace: model | description: \u6a21\u578b\u52a0\u8f7d\u5f00\u59cb\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_loaded | namespace: model | description: \u6a21\u578b\u52a0\u8f7d\u5b8c\u6210\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_loading_failed | namespace: model | description: \u6a21\u578b\u52a0\u8f7d\u5931\u8d25\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_unloaded | namespace: model | description: \u6a21\u578b\u5378\u8f7d\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: ai_processing_started | namespace: ai | description: AI\u5904\u7406\u5f00\u59cb\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: ai_processing_completed | namespace: ai | description: AI\u5904\u7406\u5b8c\u6210\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: ai_processing_error | namespace: ai | description: AI\u5904\u7406\u9519\u8bef\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: text_input_started | namespace: input | description: \u6587\u672c\u8f93\u5165\u5f00\u59cb\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: text_input_completed | namespace: input | description: \u6587\u672c\u8f93\u5165\u5b8c\u6210\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: text_input_error | namespace: input | description: \u6587\u672c\u8f93\u5165\u9519\u8bef\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: config_changed | namespace: config | description: \u914d\u7f6e\u53d8\u66f4\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: config_loaded | namespace: config | description: \u914d\u7f6e\u52a0\u8f7d\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: config_saved | namespace: config | description: \u914d\u7f6e\u4fdd\u5b58\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: window_shown | namespace: ui | description: \u7a97\u53e3\u663e\u793a\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: window_hidden | namespace: ui | description: \u7a97\u53e3\u9690\u85cf\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: tray_clicked | namespace: ui | description: \u7cfb\u7edf\u6258\u76d8\u70b9\u51fb\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: app_started | namespace: app | description: \u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: app_stopping | namespace: app | description: \u5e94\u7528\u7a0b\u5e8f\u505c\u6b62\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: streaming_started | namespace: streaming | description: \u6d41\u5f0f\u8f6c\u5f55\u5f00\u59cb\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: streaming_stopped | namespace: streaming | description: \u6d41\u5f0f\u8f6c\u5f55\u505c\u6b62\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: streaming_chunk_completed | namespace: streaming | description: \u6d41\u5f0f\u8f6c\u5f55\u5757\u5b8c\u6210\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: error_occurred | namespace: error | description: \u9519\u8bef\u53d1\u751f\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: error_auto_resolved | namespace: error | description: \u9519\u8bef\u81ea\u52a8\u6062\u590d\u4e8b\u4ef6\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: DynamicEventSystem initialized\n  builtin_events: 30\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Configuration loaded\n  config_path: C:\\Users\\Oxidane\\AppData\\Roaming\\SonicInput\\config.json | keys_loaded: 9\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: ConfigService initialized\n  config_path: C:\\Users\\Oxidane\\AppData\\Roaming\\SonicInput\\config.json | config_exists: True | structure_validated: True | event_service_enabled: True\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: StateManager initialized\n  max_history: 0 | event_service_enabled: True\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: VoiceInputApp initialized\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Initializing voice input app\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Audio system initialized\n  sample_rate: 16000 | channels: 1 | chunk_size: 1024\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Using system default audio device\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: whisper-large-v3-turbo\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: task_queue_started | namespace: default | description: \n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:09] \x1b[32mINFO\x1b[0m | model | Model: Groq client initialized on-demand\n  model: whisper-large-v3-turbo | api_key_present: True\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: whisper-large-v3-turbo | device: cloud | load_time: 0.028599262237548828\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: transcription_service_started | namespace: default | description: \n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Clipboard input initialized\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: SendInput method (ctypes) initialized\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Smart text input initialized\n  preferred_method: clipboard | fallback_enabled: True\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: RecordingController initialized\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: transcription_request | listener_id: 00760915-f113-4da8-ab8a-acf88a57064f | priority: NORMAL | is_once: False | namespace: default\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: TranscriptionController initialized\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: transcription_completed | listener_id: c73a1d65-f9a3-474d-b547-7d3741bde14d | priority: NORMAL | is_once: False | namespace: default\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: AIProcessingController initialized\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: ai_processed_text | listener_id: d26358e0-860a-4d50-a3b2-865da37f578a | priority: NORMAL | is_once: False | namespace: default\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: InputController initialized\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: All controllers initialized\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey manager initialized (win32_event_filter)\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Using legacy HotkeyManager (stable)\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener restarting\n  caller: C:\\Users\\Oxidane\\Documents\\projects\\New folder\\src\\sonicinput\\core\\hotkey_manager.py:97 | was_listening: False | registered_count: 1\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener started (win32_event_filter)\n  registered_count: 1\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey registered (pynput)\n  hotkey: f12 | normalized: f12 | action: toggle_recording | availability_tested: True\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener restarting\n  caller: C:\\Users\\Oxidane\\Documents\\projects\\New folder\\src\\sonicinput\\core\\hotkey_manager.py:97 | was_listening: True | registered_count: 2\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener started (win32_event_filter)\n  registered_count: 2\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey registered (pynput)\n  hotkey: alt+h | normalized: alt+h | action: toggle_recording | availability_tested: True\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listening already active\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: config.changed | listener_id: 660c5046-6bf6-4612-8398-2a553a874427 | priority: NORMAL | is_once: False | namespace: default\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Config hot reload enabled\n[08:31:09] \x1b[32mINFO\x1b[0m | audio | Audio: Voice input app initialized
---------------------------- Captured stdout call -----------------------------
[08:31:09] [32mINFO[0m | audio | Audio: Creating new RecordingOverlay singleton instance
[08:31:09] [32mINFO[0m | audio | Audio: RecordingOverlay singleton instance created successfully
[08:31:09] [32mINFO[0m | audio | Audio: Starting RecordingOverlay initialization
[08:31:09] [32mINFO[0m | audio | Audio: RecordingOverlay parent initialization completed
[08:31:09] [32mINFO[0m | audio | Audio: Setting up RecordingOverlay state variables
[08:31:09] [32mINFO[0m | audio | Audio: RecordingOverlay state variables initialized
[08:31:09] [32mINFO[0m | audio | Audio: Setting up RecordingOverlay window attributes
[08:31:09] [32mINFO[0m | audio | Audio: RecordingOverlay window attributes configured
[08:31:09] [32mINFO[0m | audio | Audio: Starting RecordingOverlay UI setup
[08:31:09] [32mINFO[0m | audio | Audio: OverlayUIBuilder initialized
[08:31:09] [32mINFO[0m | audio | Audio: Position manager initialized
[08:31:09] [32mINFO[0m | audio | Audio: UI components created successfully
[08:31:09] [32mINFO[0m | audio | Audio: RecordingOverlay UI setup completed
[08:31:09] [32mINFO[0m | audio | Audio: Initializing overlay components
[08:31:09] [32mINFO[0m | audio | Audio: TimerManager initialized
[08:31:09] [32mINFO[0m | audio | Audio: Timer connected: recording_timer
  timer_active: False
[08:31:09] [32mINFO[0m | audio | Audio: Timer connected: delayed_hide
  timer_active: False
[08:31:09] [32mINFO[0m | audio | Audio: AnimationController initialized
[08:31:09] [32mINFO[0m | audio | Audio: AudioVisualizer initialized
  bars_count: 5 | sensitivity: 20
[08:31:09] [32mINFO[0m | audio | Audio: AudioVisualizer initialized
[08:31:09] [32mINFO[0m | audio | Audio: Overlay components initialized successfully
[08:31:09] [32mINFO[0m | audio | Audio: Connecting RecordingOverlay thread-safe signals
[08:31:09] [32mINFO[0m | audio | Audio: RecordingOverlay all thread-safe signals connected
[08:31:09] [32mINFO[0m | audio | Audio: Recording overlay initialized successfully
  singleton_id: 1744417091648
[08:31:09] [32mINFO[0m | audio | Audio: Position manager config service set
[08:31:09] [32mINFO[0m | audio | Audio: Config service set for overlay
[08:31:09] [32mINFO[0m | audio | Audio: Event listener added
  event_name: recording_started | listener_id: 389d6d29-390e-49da-9f2d-b28c9518edaf | priority: NORMAL | is_once: False | namespace: default
[08:31:09] [32mINFO[0m | audio | Audio: Event listener added
  event_name: recording_stopped | listener_id: 6da205ea-6846-405e-aa04-da5081825ecb | priority: NORMAL | is_once: False | namespace: default
[08:31:09] [32mINFO[0m | audio | Audio: Event listener added
  event_name: ai_processing_started | listener_id: 63efafc1-4bd3-4618-8a6d-e58d7683f08e | priority: NORMAL | is_once: False | namespace: default
[08:31:09] [32mINFO[0m | audio | Audio: Event listener added
  event_name: ai_processing_completed | listener_id: a59b51c5-4c97-4d34-a233-7ab17daa9444 | priority: NORMAL | is_once: False | namespace: default
[08:31:09] [32mINFO[0m | audio | Audio: Event listener added
  event_name: text_input_completed | listener_id: 5c096d68-a46a-4e99-8632-63f03af2befc | priority: NORMAL | is_once: False | namespace: default
[08:31:09] [32mINFO[0m | audio | Audio: Event listener added
  event_name: audio_level_update | listener_id: 31af865d-b938-4b57-a307-02dabd92615a | priority: NORMAL | is_once: False | namespace: default
[08:31:09] [32mINFO[0m | audio | Audio: Event listener added
  event_name: transcription_error | listener_id: a58c211c-b5cc-42bf-88e2-79716b40af6c | priority: NORMAL | is_once: False | namespace: default
[08:31:09] [32mINFO[0m | audio | Audio: Event listener added
  event_name: ai_processing_error | listener_id: 29b006fe-e644-4500-869d-6c0d3cd74c19 | priority: NORMAL | is_once: False | namespace: default
[08:31:09] [32mINFO[0m | audio | Audio: Event listener added
  event_name: text_input_error | listener_id: 7a319f52-3f92-41e1-9560-02415a400bb8 | priority: NORMAL | is_once: False | namespace: default
___________ TestRealRecordingFunctionality.test_audio_level_updates ___________
tests\test_real_recording_functionality.py:250: in test_audio_level_updates
    assert len(level_updates) == len(test_levels)
E   AssertionError: assert 6 == 5
E    +  where 6 = len([{'level': 0.2, 'time': 1762043475.4577363}, {'level': 0.5, 'time': 1762043475.4732504}, {'level': 0.8, 'time': 1762043475.488782}, {'level': 0.3, 'time': 1762043475.504131}, {'level': 0.6, 'time': 1762043475.51958}, {'level': 0.00029006125987507403, 'time': 1762043475.6045635}])
E    +  and   5 = len([0.2, 0.5, 0.8, 0.3, 0.6])
---------------------------- Captured stdout setup ----------------------------
[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: recording_started | namespace: audio | description: \u5f55\u97f3\u5f00\u59cb\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: recording_stopped | namespace: audio | description: \u5f55\u97f3\u505c\u6b62\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: recording_error | namespace: audio | description: \u5f55\u97f3\u9519\u8bef\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: audio_level_update | namespace: audio | description: \u97f3\u9891\u7535\u5e73\u66f4\u65b0\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: transcription_started | namespace: speech | description: \u8f6c\u5f55\u5f00\u59cb\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: transcription_completed | namespace: speech | description: \u8f6c\u5f55\u5b8c\u6210\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: transcription_error | namespace: speech | description: \u8f6c\u5f55\u9519\u8bef\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_loading_started | namespace: model | description: \u6a21\u578b\u52a0\u8f7d\u5f00\u59cb\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_loaded | namespace: model | description: \u6a21\u578b\u52a0\u8f7d\u5b8c\u6210\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_loading_failed | namespace: model | description: \u6a21\u578b\u52a0\u8f7d\u5931\u8d25\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_unloaded | namespace: model | description: \u6a21\u578b\u5378\u8f7d\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: ai_processing_started | namespace: ai | description: AI\u5904\u7406\u5f00\u59cb\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: ai_processing_completed | namespace: ai | description: AI\u5904\u7406\u5b8c\u6210\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: ai_processing_error | namespace: ai | description: AI\u5904\u7406\u9519\u8bef\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: text_input_started | namespace: input | description: \u6587\u672c\u8f93\u5165\u5f00\u59cb\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: text_input_completed | namespace: input | description: \u6587\u672c\u8f93\u5165\u5b8c\u6210\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: text_input_error | namespace: input | description: \u6587\u672c\u8f93\u5165\u9519\u8bef\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: config_changed | namespace: config | description: \u914d\u7f6e\u53d8\u66f4\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: config_loaded | namespace: config | description: \u914d\u7f6e\u52a0\u8f7d\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: config_saved | namespace: config | description: \u914d\u7f6e\u4fdd\u5b58\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: window_shown | namespace: ui | description: \u7a97\u53e3\u663e\u793a\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: window_hidden | namespace: ui | description: \u7a97\u53e3\u9690\u85cf\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: tray_clicked | namespace: ui | description: \u7cfb\u7edf\u6258\u76d8\u70b9\u51fb\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: app_started | namespace: app | description: \u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: app_stopping | namespace: app | description: \u5e94\u7528\u7a0b\u5e8f\u505c\u6b62\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: streaming_started | namespace: streaming | description: \u6d41\u5f0f\u8f6c\u5f55\u5f00\u59cb\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: streaming_stopped | namespace: streaming | description: \u6d41\u5f0f\u8f6c\u5f55\u505c\u6b62\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: streaming_chunk_completed | namespace: streaming | description: \u6d41\u5f0f\u8f6c\u5f55\u5757\u5b8c\u6210\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: error_occurred | namespace: error | description: \u9519\u8bef\u53d1\u751f\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: error_auto_resolved | namespace: error | description: \u9519\u8bef\u81ea\u52a8\u6062\u590d\u4e8b\u4ef6\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: DynamicEventSystem initialized\n  builtin_events: 30\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Configuration loaded\n  config_path: C:\\Users\\Oxidane\\AppData\\Roaming\\SonicInput\\config.json | keys_loaded: 9\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: ConfigService initialized\n  config_path: C:\\Users\\Oxidane\\AppData\\Roaming\\SonicInput\\config.json | config_exists: True | structure_validated: True | event_service_enabled: True\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: StateManager initialized\n  max_history: 0 | event_service_enabled: True\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: VoiceInputApp initialized\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Initializing voice input app\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Audio system initialized\n  sample_rate: 16000 | channels: 1 | chunk_size: 1024\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Using system default audio device\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: whisper-large-v3-turbo\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: task_queue_started | namespace: default | description: \n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:15] \x1b[32mINFO\x1b[0m | model | Model: Groq client initialized on-demand\n  model: whisper-large-v3-turbo | api_key_present: True\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: whisper-large-v3-turbo | device: cloud | load_time: 0.021537065505981445\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: transcription_service_started | namespace: default | description: \n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Clipboard input initialized\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: SendInput method (ctypes) initialized\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Smart text input initialized\n  preferred_method: clipboard | fallback_enabled: True\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: RecordingController initialized\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: transcription_request | listener_id: 364ff45f-ff47-403a-a171-7e229a30deb2 | priority: NORMAL | is_once: False | namespace: default\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: TranscriptionController initialized\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: transcription_completed | listener_id: b85db8f8-6ec7-4bb8-b4cd-cfff5cf2cc70 | priority: NORMAL | is_once: False | namespace: default\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: AIProcessingController initialized\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: ai_processed_text | listener_id: a1bd911b-7777-4727-82a2-afd63df6dcac | priority: NORMAL | is_once: False | namespace: default\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: InputController initialized\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: All controllers initialized\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey manager initialized (win32_event_filter)\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Using legacy HotkeyManager (stable)\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener restarting\n  caller: C:\\Users\\Oxidane\\Documents\\projects\\New folder\\src\\sonicinput\\core\\hotkey_manager.py:97 | was_listening: False | registered_count: 1\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener started (win32_event_filter)\n  registered_count: 1\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey registered (pynput)\n  hotkey: f12 | normalized: f12 | action: toggle_recording | availability_tested: True\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener restarting\n  caller: C:\\Users\\Oxidane\\Documents\\projects\\New folder\\src\\sonicinput\\core\\hotkey_manager.py:97 | was_listening: True | registered_count: 2\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener started (win32_event_filter)\n  registered_count: 2\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey registered (pynput)\n  hotkey: alt+h | normalized: alt+h | action: toggle_recording | availability_tested: True\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listening already active\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: config.changed | listener_id: 071ff59e-dceb-47a5-9fbb-0c0279a62f7f | priority: NORMAL | is_once: False | namespace: default\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Config hot reload enabled\n[08:31:15] \x1b[32mINFO\x1b[0m | audio | Audio: Voice input app initialized
---------------------------- Captured stdout call -----------------------------
[08:31:15] [32mINFO[0m | audio | Audio: Event listener added
  event_name: audio_level_update | listener_id: ecbfa601-42a3-4953-8afb-81f3d5397d66 | priority: NORMAL | is_once: False | namespace: default
[08:31:15] [32mINFO[0m | audio | Audio: Streaming mode started
[08:31:15] [32mINFO[0m | audio | Audio: Streaming transcription started
[08:31:15] [32mINFO[0m | audio | Audio: Streaming transcription started
[08:31:15] [32mINFO[0m | audio | Audio: Streaming chunk callback set
[08:31:15] [32mINFO[0m | audio | Audio: Fallback to system default device succeeded
  attempted_devices: System Default (fallback)
[08:31:15] [32mINFO[0m | audio | Audio: Recording started
  device_id: None | sample_rate: 16000 | streaming_mode_enabled: True
[08:31:15] [32mINFO[0m | audio | Audio: Event type registered
  event_name: state_changed | namespace: default | description: 
[08:31:15] [32mINFO[0m | audio | Audio: State changed
  key: recording_state | old_value: RecordingState.IDLE | new_value: RecordingState.RECORDING | subscribers_notified: 0
[08:31:15] [32mINFO[0m | audio | Audio: Event type registered
  event_name: recording_state_changed | namespace: default | description: 
[08:31:15] [32mINFO[0m | audio | Audio: Recording started
  device_id: None | streaming_enabled: True
[08:31:15] [32mINFO[0m | audio | Audio: Stopping recording
[08:31:15] [32mINFO[0m | audio | Audio: Recording stop initiated
  timestamp: 1762043475.5380387 | chunk_size: 1024 | sample_rate: 16000 | potential_delay_ms: 64.0
[08:31:15] [32mINFO[0m | audio | Audio: Recording thread ended
  total_chunks_captured: 1 | recording_flag: False | final_timestamp: 1762043475.6045635
[08:31:15] [32mINFO[0m | audio | Audio: Recording thread joined
  join_duration_ms: 65.16504287719727 | thread_was_alive: True
[08:31:15] [32mINFO[0m | audio | Audio: Recording stopped with timing analysis
  audio_duration_seconds: 0.064 | audio_samples: 1024 | chunks_recorded: 1 | stop_process_duration_ms: 78.2630443572998 | flag_to_stream_close_ms: 76.9033432006836 | theoretical_chunk_delay_ms: 64.0 | last_chunk_timestamp: 1762043475.5380387
[08:31:15] [32mINFO[0m | audio | Audio: State changed
  key: recording_state | old_value: RecordingState.RECORDING | new_value: RecordingState.IDLE | subscribers_notified: 0
[08:31:15] [32mINFO[0m | audio | Audio: Streaming chunk added
  chunk_id: 0 | audio_length: 1024 | queue_size: 1
[08:31:15] [32mINFO[0m | audio | Audio: Final streaming chunk added
  audio_length: 1024
[08:31:15] [32mINFO[0m | audio | Audio: Event type registered
  event_name: transcription_request | namespace: default | description: 
[08:31:15] [32mINFO[0m | audio | Audio: State changed
  key: app_state | old_value: AppState.STARTING | new_value: AppState.PROCESSING | subscribers_notified: 0
[08:31:15] [32mINFO[0m | audio | Audio: Event type registered
  event_name: app_state_changed | namespace: default | description: 
[08:31:15] [32mINFO[0m | audio | Audio: Stopping streaming transcription
[08:31:15] [32mINFO[0m | audio | Audio: Processing pending chunks before stopping
  pending_count: 1
[08:31:15] [32mINFO[0m | audio | Audio: Task submitted
  task_id: f08de9af-edfe-453d-9d81-a0ca01c7c94f | task_type: process_streaming_chunk | priority: HIGH | queue_size: 1
[08:31:15] [32mINFO[0m | audio | Audio: Task execution started
  task_id: f08de9af-edfe-453d-9d81-a0ca01c7c94f | task_type: process_streaming_chunk
[08:31:15] [32mINFO[0m | audio | Audio: Event type registered
  event_name: task_submitted | namespace: default | description: 
[08:31:15] [32mINFO[0m | audio | Audio: Sending audio to Groq API
  model: whisper-large-v3-turbo | language: auto | audio_size_bytes: 2092
[08:31:15] [32mINFO[0m | audio | Audio: Submitted pending chunk for transcription
  chunk_id: 0 | audio_length: 1024
[08:31:15] [32mINFO[0m | audio | Audio: Groq transcription completed
  text_length: 11 | duration: 0.064 | processing_time: 0.3663191795349121 | rtf: 5.723737180233002 | model: whisper-large-v3-turbo
[08:31:15] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.064 | processing_time: 0.3668186664581299 | language: English | text_length: 11
[08:31:15] [32mINFO[0m | audio | Audio: Streaming chunk completed
  chunk_id: 0 | success: True | processing_time: 0.3723280429840088 | text_length: 11 | queue_size: 0
[08:31:15] [32mINFO[0m | audio | Audio: Extracted transcription text from chunks
  total_chunks: 1 | completed_chunks: 1 | text_length: 10
[08:31:15] [32mINFO[0m | audio | Audio: Streaming mode stopped
  total_chunks: 1 | completed_chunks: 1 | failed_chunks: 0 | total_audio_duration: 0.064 | average_chunk_time: 0.3723280429840088 | is_streaming: False | pending_chunks: 0 | next_chunk_id: 1 | success_rate: 100.0
[08:31:15] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: f08de9af-edfe-453d-9d81-a0ca01c7c94f | execution_time: 0.37232255935668945
[08:31:15] [32mINFO[0m | audio | Audio: Streaming transcription stopped
  total_chunks: 1 | completed_chunks: 1 | failed_chunks: 0 | total_audio_duration: 0.064 | average_chunk_time: 0.3723280429840088 | is_streaming: False | pending_chunks: 0 | next_chunk_id: 1 | success_rate: 100.0
[08:31:15] [32mINFO[0m | audio | Audio: Event type registered
  event_name: task_completed | namespace: default | description: 
[08:31:15] [32mINFO[0m | audio | Audio: Streaming transcription stopped
  text_length: 10 | stats: {"total_chunks": 1, "completed_chunks": 1, "failed_chunks": 0, "total_audio_duration": 0.064, "average_chunk_time": 0.3723280429840088, "is_streaming": false, "pending_chunks": 0, "next_chunk_id": 1, "success_rate": 100.0}
[08:31:15] [32mINFO[0m | audio | Audio: Transcription completed
  text_length: 10 | duration: 0.376s | text_preview: Thank you.
[08:31:15] [32mINFO[0m | audio | Audio: Connection pool configured successfully
[08:31:15] [32mINFO[0m | audio | Audio: NVIDIA client initialized
  has_api_key: True | api_key_length: 70 | encryption_enabled: True | base_url: https://integrate.api.nvidia.com/v1
[08:31:17] [32mINFO[0m | audio | Audio: Text refined by NVIDIA
  model: deepseek-ai/deepseek-v3.1-terminus | original_length: 10 | refined_length: 10 | response_time: 1.8690087795257568 | attempt: 1 | filter_thinking_enabled: True | prompt_tokens: 241 | completion_tokens: 4 | total_tokens: 245 | tps: 131.08552655497232 | prompt_tps: 128.94535469285032 | completion_tps: 2.140171862121997
[08:31:17] [32mINFO[0m | audio | Audio: AI refine completed
  model: deepseek-ai/deepseek-v3.1-terminus | original_length: 10 | refined_length: 10
[08:31:17] [32mINFO[0m | audio | Audio: Event type registered
  event_name: ai_processed_text | namespace: default | description: 
[08:31:17] [32mINFO[0m | audio | Audio: Starting text input
  text_length: 10 | method: clipboard | force_method: False
[08:31:17] [32mINFO[0m | audio | Audio: Clipboard backed up
  content_length: 0 | has_content: False | elevated: 1
[08:31:18] [32mINFO[0m | audio | Audio: Ctrl+V sent
[08:31:18] [32mINFO[0m | audio | Audio: Clipboard restored
  content_length: 0
[08:31:18] [32mINFO[0m | audio | Audio: Text input via clipboard successful
  text_length: 10 | restore_delay: 0.1
[08:31:18] [32mINFO[0m | audio | Audio: State changed
  key: app_state | old_value: AppState.PROCESSING | new_value: AppState.IDLE | subscribers_notified: 0
[08:31:18] [32mINFO[0m | audio | Audio: Text input completed
  duration: 0.347s | text_length: 10 | text: Thank you.
[08:31:18] [32mINFO[0m | performance | Performance: streaming_voice_input - 2.596s
  wait_time: 2.60s | final_chunk_transcribe: 0.38s | ai_tps: 131.09 | duration: 2.596s | audio_duration: 0.27s
[08:31:18] [32mINFO[0m | audio | Audio: Voice input completed
  audio_duration: 0.3s | wait_time: 2.60s
[08:31:18] [32mINFO[0m | audio | Audio: Recording stopped
  audio_duration: 0.3s | final_chunk_length: 1024
__________ TestRecordingFunctionality.test_recording_start_stop_flow __________
tests\test_recording_simple.py:81: in test_recording_start_stop_flow
    actual_audio_service.start_recording.assert_called()
E   AttributeError: 'function' object has no attribute 'assert_called'
---------------------------- Captured stdout setup ----------------------------
[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: recording_started | namespace: audio | description: \u5f55\u97f3\u5f00\u59cb\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: recording_stopped | namespace: audio | description: \u5f55\u97f3\u505c\u6b62\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: recording_error | namespace: audio | description: \u5f55\u97f3\u9519\u8bef\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: audio_level_update | namespace: audio | description: \u97f3\u9891\u7535\u5e73\u66f4\u65b0\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: transcription_started | namespace: speech | description: \u8f6c\u5f55\u5f00\u59cb\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: transcription_completed | namespace: speech | description: \u8f6c\u5f55\u5b8c\u6210\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: transcription_error | namespace: speech | description: \u8f6c\u5f55\u9519\u8bef\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_loading_started | namespace: model | description: \u6a21\u578b\u52a0\u8f7d\u5f00\u59cb\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_loaded | namespace: model | description: \u6a21\u578b\u52a0\u8f7d\u5b8c\u6210\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_loading_failed | namespace: model | description: \u6a21\u578b\u52a0\u8f7d\u5931\u8d25\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_unloaded | namespace: model | description: \u6a21\u578b\u5378\u8f7d\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: ai_processing_started | namespace: ai | description: AI\u5904\u7406\u5f00\u59cb\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: ai_processing_completed | namespace: ai | description: AI\u5904\u7406\u5b8c\u6210\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: ai_processing_error | namespace: ai | description: AI\u5904\u7406\u9519\u8bef\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: text_input_started | namespace: input | description: \u6587\u672c\u8f93\u5165\u5f00\u59cb\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: text_input_completed | namespace: input | description: \u6587\u672c\u8f93\u5165\u5b8c\u6210\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: text_input_error | namespace: input | description: \u6587\u672c\u8f93\u5165\u9519\u8bef\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: config_changed | namespace: config | description: \u914d\u7f6e\u53d8\u66f4\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: config_loaded | namespace: config | description: \u914d\u7f6e\u52a0\u8f7d\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: config_saved | namespace: config | description: \u914d\u7f6e\u4fdd\u5b58\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: window_shown | namespace: ui | description: \u7a97\u53e3\u663e\u793a\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: window_hidden | namespace: ui | description: \u7a97\u53e3\u9690\u85cf\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: tray_clicked | namespace: ui | description: \u7cfb\u7edf\u6258\u76d8\u70b9\u51fb\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: app_started | namespace: app | description: \u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: app_stopping | namespace: app | description: \u5e94\u7528\u7a0b\u5e8f\u505c\u6b62\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: streaming_started | namespace: streaming | description: \u6d41\u5f0f\u8f6c\u5f55\u5f00\u59cb\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: streaming_stopped | namespace: streaming | description: \u6d41\u5f0f\u8f6c\u5f55\u505c\u6b62\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: streaming_chunk_completed | namespace: streaming | description: \u6d41\u5f0f\u8f6c\u5f55\u5757\u5b8c\u6210\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: error_occurred | namespace: error | description: \u9519\u8bef\u53d1\u751f\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: error_auto_resolved | namespace: error | description: \u9519\u8bef\u81ea\u52a8\u6062\u590d\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: DynamicEventSystem initialized\n  builtin_events: 30\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Configuration loaded\n  config_path: C:\\Users\\Oxidane\\AppData\\Roaming\\SonicInput\\config.json | keys_loaded: 9\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: ConfigService initialized\n  config_path: C:\\Users\\Oxidane\\AppData\\Roaming\\SonicInput\\config.json | config_exists: True | structure_validated: True | event_service_enabled: True\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: StateManager initialized\n  max_history: 0 | event_service_enabled: True\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: VoiceInputApp initialized\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Initializing voice input app\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: RecordingController initialized\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: transcription_request | listener_id: 5988e839-2602-4cd2-8601-89ca1f5302d1 | priority: NORMAL | is_once: False | namespace: default\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: TranscriptionController initialized\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: transcription_completed | listener_id: c02ef85a-50bc-40db-a411-2bc5c6f401f4 | priority: NORMAL | is_once: False | namespace: default\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: AIProcessingController initialized\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: ai_processed_text | listener_id: 8fb831df-a57d-406b-9b5f-3ebb94db50ed | priority: NORMAL | is_once: False | namespace: default\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: InputController initialized\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: All controllers initialized\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey manager initialized (win32_event_filter)\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Using legacy HotkeyManager (stable)\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener restarting\n  caller: C:\\Users\\Oxidane\\Documents\\projects\\New folder\\src\\sonicinput\\core\\hotkey_manager.py:97 | was_listening: False | registered_count: 1\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener started (win32_event_filter)\n  registered_count: 1\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey registered (pynput)\n  hotkey: f12 | normalized: f12 | action: toggle_recording | availability_tested: True\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener restarting\n  caller: C:\\Users\\Oxidane\\Documents\\projects\\New folder\\src\\sonicinput\\core\\hotkey_manager.py:97 | was_listening: True | registered_count: 2\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener started (win32_event_filter)\n  registered_count: 2\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey registered (pynput)\n  hotkey: alt+h | normalized: alt+h | action: toggle_recording | availability_tested: True\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listening already active\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: config.changed | listener_id: 20dcd4db-f57a-4ec0-ac2e-4c06ea266c1b | priority: NORMAL | is_once: False | namespace: default\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Config hot reload enabled\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Voice input app initialized
---------------------------- Captured stdout call -----------------------------
[08:31:33] [32mINFO[0m | audio | Audio: Event listener added
  event_name: recording_started | listener_id: 039a7422-05bd-4a89-9e40-cc9886809702 | priority: NORMAL | is_once: False | namespace: default
[08:31:33] [32mINFO[0m | audio | Audio: Event listener added
  event_name: recording_stopped | listener_id: b7b32380-7d9c-482a-b0a6-553ca7f3393c | priority: NORMAL | is_once: False | namespace: default
[08:31:33] [32mINFO[0m | audio | Audio: Streaming transcription started
[08:31:33] [32mINFO[0m | audio | Audio: Streaming chunk callback set
[08:31:33] [32mINFO[0m | audio | Audio: Event type registered
  event_name: state_changed | namespace: default | description: 
[08:31:33] [32mINFO[0m | audio | Audio: State changed
  key: recording_state | old_value: RecordingState.IDLE | new_value: RecordingState.RECORDING | subscribers_notified: 0
[08:31:33] [32mINFO[0m | audio | Audio: Event type registered
  event_name: recording_state_changed | namespace: default | description: 
[08:31:33] [32mINFO[0m | audio | Audio: Recording started
  device_id: None | streaming_enabled: True
____________ TestRecordingFunctionality.test_audio_data_collection ____________
tests\test_recording_simple.py:142: in test_audio_data_collection
    mock_audio.set_callback.assert_called()
E   AttributeError: 'function' object has no attribute 'assert_called'
---------------------------- Captured stdout setup ----------------------------
[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: recording_started | namespace: audio | description: \u5f55\u97f3\u5f00\u59cb\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: recording_stopped | namespace: audio | description: \u5f55\u97f3\u505c\u6b62\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: recording_error | namespace: audio | description: \u5f55\u97f3\u9519\u8bef\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: audio_level_update | namespace: audio | description: \u97f3\u9891\u7535\u5e73\u66f4\u65b0\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: transcription_started | namespace: speech | description: \u8f6c\u5f55\u5f00\u59cb\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: transcription_completed | namespace: speech | description: \u8f6c\u5f55\u5b8c\u6210\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: transcription_error | namespace: speech | description: \u8f6c\u5f55\u9519\u8bef\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_loading_started | namespace: model | description: \u6a21\u578b\u52a0\u8f7d\u5f00\u59cb\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_loaded | namespace: model | description: \u6a21\u578b\u52a0\u8f7d\u5b8c\u6210\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_loading_failed | namespace: model | description: \u6a21\u578b\u52a0\u8f7d\u5931\u8d25\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_unloaded | namespace: model | description: \u6a21\u578b\u5378\u8f7d\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: ai_processing_started | namespace: ai | description: AI\u5904\u7406\u5f00\u59cb\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: ai_processing_completed | namespace: ai | description: AI\u5904\u7406\u5b8c\u6210\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: ai_processing_error | namespace: ai | description: AI\u5904\u7406\u9519\u8bef\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: text_input_started | namespace: input | description: \u6587\u672c\u8f93\u5165\u5f00\u59cb\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: text_input_completed | namespace: input | description: \u6587\u672c\u8f93\u5165\u5b8c\u6210\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: text_input_error | namespace: input | description: \u6587\u672c\u8f93\u5165\u9519\u8bef\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: config_changed | namespace: config | description: \u914d\u7f6e\u53d8\u66f4\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: config_loaded | namespace: config | description: \u914d\u7f6e\u52a0\u8f7d\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: config_saved | namespace: config | description: \u914d\u7f6e\u4fdd\u5b58\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: window_shown | namespace: ui | description: \u7a97\u53e3\u663e\u793a\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: window_hidden | namespace: ui | description: \u7a97\u53e3\u9690\u85cf\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: tray_clicked | namespace: ui | description: \u7cfb\u7edf\u6258\u76d8\u70b9\u51fb\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: app_started | namespace: app | description: \u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: app_stopping | namespace: app | description: \u5e94\u7528\u7a0b\u5e8f\u505c\u6b62\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: streaming_started | namespace: streaming | description: \u6d41\u5f0f\u8f6c\u5f55\u5f00\u59cb\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: streaming_stopped | namespace: streaming | description: \u6d41\u5f0f\u8f6c\u5f55\u505c\u6b62\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: streaming_chunk_completed | namespace: streaming | description: \u6d41\u5f0f\u8f6c\u5f55\u5757\u5b8c\u6210\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: error_occurred | namespace: error | description: \u9519\u8bef\u53d1\u751f\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: error_auto_resolved | namespace: error | description: \u9519\u8bef\u81ea\u52a8\u6062\u590d\u4e8b\u4ef6\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: DynamicEventSystem initialized\n  builtin_events: 30\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Configuration loaded\n  config_path: C:\\Users\\Oxidane\\AppData\\Roaming\\SonicInput\\config.json | keys_loaded: 9\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: ConfigService initialized\n  config_path: C:\\Users\\Oxidane\\AppData\\Roaming\\SonicInput\\config.json | config_exists: True | structure_validated: True | event_service_enabled: True\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: StateManager initialized\n  max_history: 0 | event_service_enabled: True\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: VoiceInputApp initialized\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Initializing voice input app\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: RecordingController initialized\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: transcription_request | listener_id: b1c93b47-2c09-471b-a11c-ad6a05568fb2 | priority: NORMAL | is_once: False | namespace: default\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: TranscriptionController initialized\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: transcription_completed | listener_id: 2393bf54-3b09-438f-ae9d-b9ab46e50729 | priority: NORMAL | is_once: False | namespace: default\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: AIProcessingController initialized\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: ai_processed_text | listener_id: 9e913596-95bd-47ec-9837-81b14c426693 | priority: NORMAL | is_once: False | namespace: default\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: InputController initialized\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: All controllers initialized\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey manager initialized (win32_event_filter)\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Using legacy HotkeyManager (stable)\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener restarting\n  caller: C:\\Users\\Oxidane\\Documents\\projects\\New folder\\src\\sonicinput\\core\\hotkey_manager.py:97 | was_listening: False | registered_count: 1\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener started (win32_event_filter)\n  registered_count: 1\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey registered (pynput)\n  hotkey: f12 | normalized: f12 | action: toggle_recording | availability_tested: True\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener restarting\n  caller: C:\\Users\\Oxidane\\Documents\\projects\\New folder\\src\\sonicinput\\core\\hotkey_manager.py:97 | was_listening: True | registered_count: 2\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener started (win32_event_filter)\n  registered_count: 2\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey registered (pynput)\n  hotkey: alt+h | normalized: alt+h | action: toggle_recording | availability_tested: True\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listening already active\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: config.changed | listener_id: 0fbb2afc-649b-4ef4-bf38-4ac4d7294ab1 | priority: NORMAL | is_once: False | namespace: default\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Config hot reload enabled\n[08:31:33] \x1b[32mINFO\x1b[0m | audio | Audio: Voice input app initialized
---------------------------- Captured stdout call -----------------------------
[08:31:33] [32mINFO[0m | audio | Audio: Streaming transcription started
[08:31:33] [32mINFO[0m | audio | Audio: Streaming chunk callback set
[08:31:33] [32mINFO[0m | audio | Audio: Event type registered
  event_name: state_changed | namespace: default | description: 
[08:31:33] [32mINFO[0m | audio | Audio: State changed
  key: recording_state | old_value: RecordingState.IDLE | new_value: RecordingState.RECORDING | subscribers_notified: 0
[08:31:33] [32mINFO[0m | audio | Audio: Event type registered
  event_name: recording_state_changed | namespace: default | description: 
[08:31:33] [32mINFO[0m | audio | Audio: Recording started
  device_id: None | streaming_enabled: True
[08:31:33] [32mINFO[0m | audio | Audio: Stopping recording
[08:31:33] [32mINFO[0m | audio | Audio: State changed
  key: recording_state | old_value: RecordingState.RECORDING | new_value: RecordingState.IDLE | subscribers_notified: 0
[08:31:33] [32mINFO[0m | audio | Audio: Final streaming chunk added
  audio_length: 80000
[08:31:33] [32mINFO[0m | audio | Audio: Event type registered
  event_name: transcription_request | namespace: default | description: 
[08:31:33] [32mINFO[0m | audio | Audio: State changed
  key: app_state | old_value: AppState.STARTING | new_value: AppState.PROCESSING | subscribers_notified: 0
[08:31:33] [32mINFO[0m | audio | Audio: Event type registered
  event_name: app_state_changed | namespace: default | description: 
[08:31:33] [32mINFO[0m | audio | Audio: Stopping streaming transcription
[08:31:33] [32mINFO[0m | audio | Audio: State changed
  key: app_state | old_value: AppState.PROCESSING | new_value: AppState.IDLE | subscribers_notified: 0
[08:31:33] [32mINFO[0m | audio | Audio: Recording stopped
  audio_duration: 0.0s | final_chunk_length: 80000
---------------------------- Captured stderr call -----------------------------
[08:31:33] [31mERROR[0m | error | Error in process_streaming_transcription
  traceback: Traceback (most recent call last):
  File "C:\Users\Oxidane\Documents\projects\New folder\src\sonicinput\core\controllers\transcription_controller.py", line 119, in process_streaming_transcription
    text = result.get("text", "")
AttributeError: 'str' object has no attribute 'get'
 | error_details: 'str' object has no attribute 'get' | exception: 'str' object has no attribute 'get' | exception_type: AttributeError
__________ TestRecordingFunctionality.test_multiple_recording_cycles __________
tests\test_recording_simple.py:269: in test_multiple_recording_cycles
    assert mock_audio.start_recording.call_count == cycles
E   AttributeError: 'function' object has no attribute 'call_count'
---------------------------- Captured stdout setup ----------------------------
[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: recording_started | namespace: audio | description: \u5f55\u97f3\u5f00\u59cb\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: recording_stopped | namespace: audio | description: \u5f55\u97f3\u505c\u6b62\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: recording_error | namespace: audio | description: \u5f55\u97f3\u9519\u8bef\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: audio_level_update | namespace: audio | description: \u97f3\u9891\u7535\u5e73\u66f4\u65b0\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: transcription_started | namespace: speech | description: \u8f6c\u5f55\u5f00\u59cb\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: transcription_completed | namespace: speech | description: \u8f6c\u5f55\u5b8c\u6210\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: transcription_error | namespace: speech | description: \u8f6c\u5f55\u9519\u8bef\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_loading_started | namespace: model | description: \u6a21\u578b\u52a0\u8f7d\u5f00\u59cb\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_loaded | namespace: model | description: \u6a21\u578b\u52a0\u8f7d\u5b8c\u6210\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_loading_failed | namespace: model | description: \u6a21\u578b\u52a0\u8f7d\u5931\u8d25\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: model_unloaded | namespace: model | description: \u6a21\u578b\u5378\u8f7d\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: ai_processing_started | namespace: ai | description: AI\u5904\u7406\u5f00\u59cb\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: ai_processing_completed | namespace: ai | description: AI\u5904\u7406\u5b8c\u6210\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: ai_processing_error | namespace: ai | description: AI\u5904\u7406\u9519\u8bef\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: text_input_started | namespace: input | description: \u6587\u672c\u8f93\u5165\u5f00\u59cb\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: text_input_completed | namespace: input | description: \u6587\u672c\u8f93\u5165\u5b8c\u6210\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: text_input_error | namespace: input | description: \u6587\u672c\u8f93\u5165\u9519\u8bef\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: config_changed | namespace: config | description: \u914d\u7f6e\u53d8\u66f4\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: config_loaded | namespace: config | description: \u914d\u7f6e\u52a0\u8f7d\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: config_saved | namespace: config | description: \u914d\u7f6e\u4fdd\u5b58\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: window_shown | namespace: ui | description: \u7a97\u53e3\u663e\u793a\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: window_hidden | namespace: ui | description: \u7a97\u53e3\u9690\u85cf\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: tray_clicked | namespace: ui | description: \u7cfb\u7edf\u6258\u76d8\u70b9\u51fb\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: app_started | namespace: app | description: \u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: app_stopping | namespace: app | description: \u5e94\u7528\u7a0b\u5e8f\u505c\u6b62\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: streaming_started | namespace: streaming | description: \u6d41\u5f0f\u8f6c\u5f55\u5f00\u59cb\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: streaming_stopped | namespace: streaming | description: \u6d41\u5f0f\u8f6c\u5f55\u505c\u6b62\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: streaming_chunk_completed | namespace: streaming | description: \u6d41\u5f0f\u8f6c\u5f55\u5757\u5b8c\u6210\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: error_occurred | namespace: error | description: \u9519\u8bef\u53d1\u751f\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event type registered\n  event_name: error_auto_resolved | namespace: error | description: \u9519\u8bef\u81ea\u52a8\u6062\u590d\u4e8b\u4ef6\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: DynamicEventSystem initialized\n  builtin_events: 30\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Configuration loaded\n  config_path: C:\\Users\\Oxidane\\AppData\\Roaming\\SonicInput\\config.json | keys_loaded: 9\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: ConfigService initialized\n  config_path: C:\\Users\\Oxidane\\AppData\\Roaming\\SonicInput\\config.json | config_exists: True | structure_validated: True | event_service_enabled: True\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: StateManager initialized\n  max_history: 0 | event_service_enabled: True\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: VoiceInputApp initialized\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Initializing voice input app\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: RecordingController initialized\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: transcription_request | listener_id: 1509c443-ef2f-4d09-a56b-d1212b9de57c | priority: NORMAL | is_once: False | namespace: default\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: TranscriptionController initialized\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: transcription_completed | listener_id: 166390f3-f739-4096-b4d0-4f8ede3c12d7 | priority: NORMAL | is_once: False | namespace: default\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: AIProcessingController initialized\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: ai_processed_text | listener_id: 0c653a67-fc06-4b21-ad93-19a11bb20fd8 | priority: NORMAL | is_once: False | namespace: default\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: InputController initialized\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: All controllers initialized\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey manager initialized (win32_event_filter)\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Using legacy HotkeyManager (stable)\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener restarting\n  caller: C:\\Users\\Oxidane\\Documents\\projects\\New folder\\src\\sonicinput\\core\\hotkey_manager.py:97 | was_listening: False | registered_count: 1\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener started (win32_event_filter)\n  registered_count: 1\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey registered (pynput)\n  hotkey: f12 | normalized: f12 | action: toggle_recording | availability_tested: True\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener restarting\n  caller: C:\\Users\\Oxidane\\Documents\\projects\\New folder\\src\\sonicinput\\core\\hotkey_manager.py:97 | was_listening: True | registered_count: 2\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listener started (win32_event_filter)\n  registered_count: 2\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey registered (pynput)\n  hotkey: alt+h | normalized: alt+h | action: toggle_recording | availability_tested: True\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Hotkey listening already active\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Event listener added\n  event_name: config.changed | listener_id: 336fbb6f-0fd9-4bca-a7b1-4dd34d0d532a | priority: NORMAL | is_once: False | namespace: default\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Config hot reload enabled\n[08:31:34] \x1b[32mINFO\x1b[0m | audio | Audio: Voice input app initialized
---------------------------- Captured stdout call -----------------------------
[08:31:34] [32mINFO[0m | audio | Audio: Streaming transcription started
[08:31:34] [32mINFO[0m | audio | Audio: Streaming chunk callback set
[08:31:34] [32mINFO[0m | audio | Audio: Event type registered
  event_name: state_changed | namespace: default | description: 
[08:31:34] [32mINFO[0m | audio | Audio: State changed
  key: recording_state | old_value: RecordingState.IDLE | new_value: RecordingState.RECORDING | subscribers_notified: 0
[08:31:34] [32mINFO[0m | audio | Audio: Event type registered
  event_name: recording_state_changed | namespace: default | description: 
[08:31:34] [32mINFO[0m | audio | Audio: Recording started
  device_id: None | streaming_enabled: True
[08:31:34] [32mINFO[0m | audio | Audio: Stopping recording
[08:31:34] [32mINFO[0m | audio | Audio: State changed
  key: recording_state | old_value: RecordingState.RECORDING | new_value: RecordingState.IDLE | subscribers_notified: 0
[08:31:34] [32mINFO[0m | audio | Audio: Final streaming chunk added
  audio_length: 80000
[08:31:34] [32mINFO[0m | audio | Audio: Event type registered
  event_name: transcription_request | namespace: default | description: 
[08:31:34] [32mINFO[0m | audio | Audio: State changed
  key: app_state | old_value: AppState.STARTING | new_value: AppState.PROCESSING | subscribers_notified: 0
[08:31:34] [32mINFO[0m | audio | Audio: Event type registered
  event_name: app_state_changed | namespace: default | description: 
[08:31:34] [32mINFO[0m | audio | Audio: Stopping streaming transcription
[08:31:34] [32mINFO[0m | audio | Audio: State changed
  key: app_state | old_value: AppState.PROCESSING | new_value: AppState.IDLE | subscribers_notified: 0
[08:31:34] [32mINFO[0m | audio | Audio: Recording stopped
  audio_duration: 0.1s | final_chunk_length: 80000
[08:31:34] [32mINFO[0m | audio | Audio: Streaming transcription started
[08:31:34] [32mINFO[0m | audio | Audio: Streaming chunk callback set
[08:31:34] [32mINFO[0m | audio | Audio: State changed
  key: recording_state | old_value: RecordingState.IDLE | new_value: RecordingState.RECORDING | subscribers_notified: 0
[08:31:34] [32mINFO[0m | audio | Audio: Recording started
  device_id: None | streaming_enabled: True
[08:31:34] [32mINFO[0m | audio | Audio: Stopping recording
[08:31:34] [32mINFO[0m | audio | Audio: State changed
  key: recording_state | old_value: RecordingState.RECORDING | new_value: RecordingState.IDLE | subscribers_notified: 0
[08:31:34] [32mINFO[0m | audio | Audio: Final streaming chunk added
  audio_length: 80000
[08:31:34] [32mINFO[0m | audio | Audio: State changed
  key: app_state | old_value: AppState.IDLE | new_value: AppState.PROCESSING | subscribers_notified: 0
[08:31:34] [32mINFO[0m | audio | Audio: Stopping streaming transcription
[08:31:34] [32mINFO[0m | audio | Audio: State changed
  key: app_state | old_value: AppState.PROCESSING | new_value: AppState.IDLE | subscribers_notified: 0
[08:31:34] [32mINFO[0m | audio | Audio: Recording stopped
  audio_duration: 0.1s | final_chunk_length: 80000
[08:31:34] [32mINFO[0m | audio | Audio: Streaming transcription started
[08:31:34] [32mINFO[0m | audio | Audio: Streaming chunk callback set
[08:31:34] [32mINFO[0m | audio | Audio: State changed
  key: recording_state | old_value: RecordingState.IDLE | new_value: RecordingState.RECORDING | subscribers_notified: 0
[08:31:34] [32mINFO[0m | audio | Audio: Recording started
  device_id: None | streaming_enabled: True
[08:31:34] [32mINFO[0m | audio | Audio: Stopping recording
[08:31:34] [32mINFO[0m | audio | Audio: State changed
  key: recording_state | old_value: RecordingState.RECORDING | new_value: RecordingState.IDLE | subscribers_notified: 0
[08:31:34] [32mINFO[0m | audio | Audio: Final streaming chunk added
  audio_length: 80000
[08:31:34] [32mINFO[0m | audio | Audio: State changed
  key: app_state | old_value: AppState.IDLE | new_value: AppState.PROCESSING | subscribers_notified: 0
[08:31:34] [32mINFO[0m | audio | Audio: Stopping streaming transcription
[08:31:34] [32mINFO[0m | audio | Audio: State changed
  key: app_state | old_value: AppState.PROCESSING | new_value: AppState.IDLE | subscribers_notified: 0
[08:31:34] [32mINFO[0m | audio | Audio: Recording stopped
  audio_duration: 0.1s | final_chunk_length: 80000
---------------------------- Captured stderr call -----------------------------
[08:31:34] [31mERROR[0m | error | Error in process_streaming_transcription
  traceback: Traceback (most recent call last):
  File "C:\Users\Oxidane\Documents\projects\New folder\src\sonicinput\core\controllers\transcription_controller.py", line 119, in process_streaming_transcription
    text = result.get("text", "")
AttributeError: 'str' object has no attribute 'get'
 | error_details: 'str' object has no attribute 'get' | exception: 'str' object has no attribute 'get' | exception_type: AttributeError
[08:31:34] [31mERROR[0m | error | Error in process_streaming_transcription
  traceback: Traceback (most recent call last):
  File "C:\Users\Oxidane\Documents\projects\New folder\src\sonicinput\core\controllers\transcription_controller.py", line 119, in process_streaming_transcription
    text = result.get("text", "")
AttributeError: 'str' object has no attribute 'get'
 | error_details: 'str' object has no attribute 'get' | exception: 'str' object has no attribute 'get' | exception_type: AttributeError
[08:31:34] [31mERROR[0m | error | Error in process_streaming_transcription
  traceback: Traceback (most recent call last):
  File "C:\Users\Oxidane\Documents\projects\New folder\src\sonicinput\core\controllers\transcription_controller.py", line 119, in process_streaming_transcription
    text = result.get("text", "")
AttributeError: 'str' object has no attribute 'get'
 | error_details: 'str' object has no attribute 'get' | exception: 'str' object has no attribute 'get' | exception_type: AttributeError
________ TestTranscriptionServiceBasics.test_service_starts_and_stops _________
tests\test_streaming_transcription.py:96: in test_service_starts_and_stops
    assert service._is_running
E   AttributeError: 'RefactoredTranscriptionService' object has no attribute '_is_running'
---------------------------- Captured stdout call -----------------------------
[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744493933568'>\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744493933568'> | device: <MagicMock name='mock().device' id='1744494046336'> | load_time: 0.0\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
___________ TestTranscriptionServiceBasics.test_async_transcription ___________
tests\test_streaming_transcription.py:149: in test_async_transcription
    assert result_container["result"].success
E   AttributeError: 'dict' object has no attribute 'success'
---------------------------- Captured stdout setup ----------------------------
[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744494995984'>\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744494995984'> | device: <MagicMock name='mock().device' id='1744495059552'> | load_time: 0.0\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
---------------------------- Captured stdout call -----------------------------
[08:31:35] [32mINFO[0m | audio | Audio: Task submitted
  task_id: 7ac96612-f353-48ee-9d05-c7231ba60785 | task_type: transcribe | priority: NORMAL | queue_size: 1
[08:31:35] [32mINFO[0m | audio | Audio: Task execution started
  task_id: 7ac96612-f353-48ee-9d05-c7231ba60785 | task_type: transcribe
[08:31:35] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 2.0 | processing_time: 0.0004994869232177734 | language: <MagicMock name='mock().transcribe().get()' id='1744495263552'> | text_length: 0
[08:31:35] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: 7ac96612-f353-48ee-9d05-c7231ba60785 | execution_time: 0.0035009384155273438
____________ TestStreamingTranscription.test_streaming_mode_basic _____________
tests\test_streaming_transcription.py:161: in test_streaming_mode_basic
    transcription_service.start_streaming_mode()
E   AttributeError: 'RefactoredTranscriptionService' object has no attribute 'start_streaming_mode'. Did you mean: 'start_streaming'?
---------------------------- Captured stdout setup ----------------------------
[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744495668688'>\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744495668688'> | device: <MagicMock name='mock().device' id='1744495486496'> | load_time: 0.0\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
_________ TestStreamingTranscription.test_multiple_streaming_sessions _________
tests\test_streaming_transcription.py:183: in test_multiple_streaming_sessions
    transcription_service.start_streaming_mode()
E   AttributeError: 'RefactoredTranscriptionService' object has no attribute 'start_streaming_mode'. Did you mean: 'start_streaming'?
---------------------------- Captured stdout setup ----------------------------
[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744495725488'>\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744495725488'> | device: <MagicMock name='mock().device' id='1744495789056'> | load_time: 0.0\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
_________ TestStreamingTranscription.test_streaming_with_many_chunks __________
tests\test_streaming_transcription.py:203: in test_streaming_with_many_chunks
    transcription_service.start_streaming_mode()
E   AttributeError: 'RefactoredTranscriptionService' object has no attribute 'start_streaming_mode'. Did you mean: 'start_streaming'?
---------------------------- Captured stdout setup ----------------------------
[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744496132640'>\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744496132640'> | device: <MagicMock name='mock().device' id='1744496288160'> | load_time: 0.0004990100860595703\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:35] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
____________ TestStreamingTranscription.test_streaming_chunk_order ____________
tests\test_streaming_transcription.py:220: in test_streaming_chunk_order
    transcription_service.start_streaming_mode()
E   AttributeError: 'RefactoredTranscriptionService' object has no attribute 'start_streaming_mode'. Did you mean: 'start_streaming'?
---------------------------- Captured stdout setup ----------------------------
[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744492061232'>\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744492061232'> | device: <MagicMock name='mock().device' id='1744492600800'> | load_time: 0.0005004405975341797\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
______ TestGPUMemoryManagement.test_rapid_transcription_no_resource_leak ______
tests\test_streaming_transcription.py:287: in test_rapid_transcription_no_resource_leak
    assert all(r.success for r in results if r is not None)
tests\test_streaming_transcription.py:287: in <genexpr>
    assert all(r.success for r in results if r is not None)
E   AttributeError: 'dict' object has no attribute 'success'
---------------------------- Captured stdout setup ----------------------------
[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744513598704'>\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744513598704'> | device: <MagicMock name='mock().device' id='1744513539648'> | load_time: 0.0\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
---------------------------- Captured stdout call -----------------------------
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: 3ddc062c-1ddd-4f52-80d0-9d5a58e2ec86 | task_type: transcribe | priority: NORMAL | queue_size: 1
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: 3ddc062c-1ddd-4f52-80d0-9d5a58e2ec86 | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: 0d177c16-d699-4a51-ae75-d184d9648549 | task_type: transcribe | priority: NORMAL | queue_size: 1
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: 82ff30dc-18ea-4dc2-960e-6e1d98c349f3 | task_type: transcribe | priority: NORMAL | queue_size: 2
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: 3ddc062c-1ddd-4f52-80d0-9d5a58e2ec86 | execution_time: 0.0024995803833007812
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: b5332735-669f-493d-97ba-f802c32a2cd7 | task_type: transcribe | priority: NORMAL | queue_size: 3
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: 0d177c16-d699-4a51-ae75-d184d9648549 | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: 808f55ca-5782-4973-9780-733b9c346712 | task_type: transcribe | priority: NORMAL | queue_size: 3
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: b8ccea76-069b-4d1c-bfa3-ef6f4f247b97 | task_type: transcribe | priority: NORMAL | queue_size: 4
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: 0d177c16-d699-4a51-ae75-d184d9648549 | execution_time: 0.0014948844909667969
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: 65365da8-5085-4b4c-9009-cdbd70f8ed5a | task_type: transcribe | priority: NORMAL | queue_size: 5
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: 82ff30dc-18ea-4dc2-960e-6e1d98c349f3 | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: 2f0f978f-5e36-4da1-805c-ac6399a48165 | task_type: transcribe | priority: NORMAL | queue_size: 5
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: 86e7e88c-961b-418d-8409-3ee238e8c62b | task_type: transcribe | priority: NORMAL | queue_size: 6
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: 82ff30dc-18ea-4dc2-960e-6e1d98c349f3 | execution_time: 0.0015017986297607422
[08:31:36] [32mINFO[0m | audio | Audio: Task submitted
  task_id: 4b28ed20-fd73-4f90-8b88-04cd4677f2a0 | task_type: transcribe | priority: NORMAL | queue_size: 7
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: b5332735-669f-493d-97ba-f802c32a2cd7 | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: b5332735-669f-493d-97ba-f802c32a2cd7 | execution_time: 0.0010004043579101562
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: 808f55ca-5782-4973-9780-733b9c346712 | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: 808f55ca-5782-4973-9780-733b9c346712 | execution_time: 0.00099945068359375
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: b8ccea76-069b-4d1c-bfa3-ef6f4f247b97 | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: b8ccea76-069b-4d1c-bfa3-ef6f4f247b97 | execution_time: 0.0005021095275878906
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: 65365da8-5085-4b4c-9009-cdbd70f8ed5a | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: 65365da8-5085-4b4c-9009-cdbd70f8ed5a | execution_time: 0.0010046958923339844
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: 2f0f978f-5e36-4da1-805c-ac6399a48165 | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: 2f0f978f-5e36-4da1-805c-ac6399a48165 | execution_time: 0.0010154247283935547
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: 86e7e88c-961b-418d-8409-3ee238e8c62b | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: 86e7e88c-961b-418d-8409-3ee238e8c62b | execution_time: 0.0009989738464355469
[08:31:36] [32mINFO[0m | audio | Audio: Task execution started
  task_id: 4b28ed20-fd73-4f90-8b88-04cd4677f2a0 | task_type: transcribe
[08:31:36] [32mINFO[0m | audio | Audio: Audio transcribed successfully
  duration: 0.5 | processing_time: 0.0 | language: <MagicMock name='mock().transcribe().get()' id='1744513645776'> | text_length: 0
[08:31:36] [32mINFO[0m | audio | Audio: Task completed successfully
  task_id: 4b28ed20-fd73-4f90-8b88-04cd4677f2a0 | execution_time: 0.0004982948303222656
_____________ TestErrorHandling.test_transcription_error_recovery _____________
tests\test_streaming_transcription.py:321: in test_transcription_error_recovery
    assert result_container["error"] is not None
E   assert None is not None

During handling of the above exception, another exception occurred:
tests\test_streaming_transcription.py:341: in test_transcription_error_recovery
    service.stop(timeout=2.0)
E   TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
---------------------------- Captured stdout call -----------------------------
[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744514193664'>\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744514193664'> | device: <MagicMock name='mock().device' id='1744514322816'> | load_time: 0.0004987716674804688\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task submitted\n  task_id: f6eb486e-4e76-4233-901b-a868dbe4d4f7 | task_type: transcribe | priority: NORMAL | queue_size: 1\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task execution started\n  task_id: f6eb486e-4e76-4233-901b-a868dbe4d4f7 | task_type: transcribe\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Audio transcribed successfully\n  duration: 1.0 | processing_time: 0.0004999637603759766 | language: <MagicMock name='mock().transcribe().get()' id='1744514461328'> | text_length: 0\n[08:31:36] \x1b[32mINFO\x1b[0m | audio | Audio: Task completed successfully\n  task_id: f6eb486e-4e76-4233-901b-a868dbe4d4f7 | execution_time: 0.0030040740966796875
_____________ TestErrorHandling.test_streaming_with_failed_chunks _____________
tests\test_streaming_transcription.py:362: in test_streaming_with_failed_chunks
    transcription_service.whisper_engine.transcribe.side_effect = mock_transcribe_with_failure
E   AttributeError: 'RefactoredTranscriptionService' object has no attribute 'whisper_engine'
---------------------------- Captured stdout setup ----------------------------
[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744514846816'>\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744514846816'> | device: <MagicMock name='mock().device' id='1744514959440'> | load_time: 0.0005011558532714844\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
_______________ TestPerformance.test_streaming_reduces_latency ________________
tests\test_streaming_transcription.py:397: in test_streaming_reduces_latency
    transcription_service.start_streaming_mode()
E   AttributeError: 'RefactoredTranscriptionService' object has no attribute 'start_streaming_mode'. Did you mean: 'start_streaming'?
---------------------------- Captured stdout setup ----------------------------
[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744515331264'>\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744515331264'> | device: <MagicMock name='mock().device' id='1744515427600'> | load_time: 0.0005054473876953125\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
_____________ TestIntegration.test_realistic_voice_input_workflow _____________
tests\test_streaming_transcription.py:434: in test_realistic_voice_input_workflow
    transcription_service.start_streaming_mode()
E   AttributeError: 'RefactoredTranscriptionService' object has no attribute 'start_streaming_mode'. Did you mean: 'start_streaming'?
---------------------------- Captured stdout setup ----------------------------
[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: StreamingCoordinator initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager initialized\n  worker_count: 1\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reload_model | description: \u91cd\u65b0\u52a0\u8f7d\u6a21\u578b | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: switch_to_cpu | description: \u5207\u6362\u5230CPU\u6a21\u5f0f | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: reset_audio_device | description: \u91cd\u7f6e\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: fallback_audio_device | description: \u4f7f\u7528\u5907\u7528\u97f3\u9891\u8bbe\u5907 | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Recovery action registered\n  action_id: clear_cache | description: \u6e05\u7406\u7f13\u5b58 | auto_recovery: True\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: ErrorRecoveryService initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: transcribe\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: load_model\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: reload_model\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Task handler registered\n  task_type: process_streaming_chunk\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService initialized\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: ModelManager started\n  initial_model: <MagicMock name='mock().model_name' id='1744515650208'>\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Worker thread started\n  worker_name: TaskWorker-0\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: TaskQueueManager started\n  worker_count: 1\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Loading model on service startup\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Model loaded successfully\n  model_name: <MagicMock name='mock().model_name' id='1744515650208'> | device: <MagicMock name='mock().device' id='1744515535616'> | load_time: 0.0\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: Transcription core created successfully\n[08:31:41] \x1b[32mINFO\x1b[0m | audio | Audio: RefactoredTranscriptionService started\n  transcription_core_available: True
=========================== short test summary info ===========================
FAILED tests/test_cloud_transcription_services.py::test_factory_from_config_no_api_key_fallback - assert None is not None
FAILED tests/test_real_recording_functionality.py::TestRealRecordingFunctionality::test_overlay_integration - AttributeError: 'VoiceInputApp' object has no attribute '_validate_overlay_state'
FAILED tests/test_real_recording_functionality.py::TestRealRecordingFunctionality::test_audio_level_updates - AssertionError: assert 6 == 5
 +  where 6 = len([{'level': 0.2, 'time': 1762043475.4577363}, {'level': 0.5, 'time': 1762043475.4732504}, {'level': 0.8, 'time': 1762043475.488782}, {'level': 0.3, 'time': 1762043475.504131}, {'level': 0.6, 'time': 1762043475.51958}, {'level': 0.00029006125987507403, 'time': 1762043475.6045635}])
 +  and   5 = len([0.2, 0.5, 0.8, 0.3, 0.6])
FAILED tests/test_recording_simple.py::TestRecordingFunctionality::test_recording_start_stop_flow - AttributeError: 'function' object has no attribute 'assert_called'
FAILED tests/test_recording_simple.py::TestRecordingFunctionality::test_audio_data_collection - AttributeError: 'function' object has no attribute 'assert_called'
FAILED tests/test_recording_simple.py::TestRecordingFunctionality::test_multiple_recording_cycles - AttributeError: 'function' object has no attribute 'call_count'
FAILED tests/test_streaming_transcription.py::TestTranscriptionServiceBasics::test_service_starts_and_stops - AttributeError: 'RefactoredTranscriptionService' object has no attribute '_is_running'
FAILED tests/test_streaming_transcription.py::TestTranscriptionServiceBasics::test_async_transcription - AttributeError: 'dict' object has no attribute 'success'
FAILED tests/test_streaming_transcription.py::TestStreamingTranscription::test_streaming_mode_basic - AttributeError: 'RefactoredTranscriptionService' object has no attribute 'start_streaming_mode'. Did you mean: 'start_streaming'?
FAILED tests/test_streaming_transcription.py::TestStreamingTranscription::test_multiple_streaming_sessions - AttributeError: 'RefactoredTranscriptionService' object has no attribute 'start_streaming_mode'. Did you mean: 'start_streaming'?
FAILED tests/test_streaming_transcription.py::TestStreamingTranscription::test_streaming_with_many_chunks - AttributeError: 'RefactoredTranscriptionService' object has no attribute 'start_streaming_mode'. Did you mean: 'start_streaming'?
FAILED tests/test_streaming_transcription.py::TestStreamingTranscription::test_streaming_chunk_order - AttributeError: 'RefactoredTranscriptionService' object has no attribute 'start_streaming_mode'. Did you mean: 'start_streaming'?
FAILED tests/test_streaming_transcription.py::TestGPUMemoryManagement::test_rapid_transcription_no_resource_leak - AttributeError: 'dict' object has no attribute 'success'
FAILED tests/test_streaming_transcription.py::TestErrorHandling::test_transcription_error_recovery - TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
FAILED tests/test_streaming_transcription.py::TestErrorHandling::test_streaming_with_failed_chunks - AttributeError: 'RefactoredTranscriptionService' object has no attribute 'whisper_engine'
FAILED tests/test_streaming_transcription.py::TestPerformance::test_streaming_reduces_latency - AttributeError: 'RefactoredTranscriptionService' object has no attribute 'start_streaming_mode'. Did you mean: 'start_streaming'?
FAILED tests/test_streaming_transcription.py::TestIntegration::test_realistic_voice_input_workflow - AttributeError: 'RefactoredTranscriptionService' object has no attribute 'start_streaming_mode'. Did you mean: 'start_streaming'?
ERROR tests/test_streaming_transcription.py::TestTranscriptionServiceBasics::test_single_transcription - TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
ERROR tests/test_streaming_transcription.py::TestTranscriptionServiceBasics::test_async_transcription - TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
ERROR tests/test_streaming_transcription.py::TestStreamingTranscription::test_streaming_mode_basic - TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
ERROR tests/test_streaming_transcription.py::TestStreamingTranscription::test_multiple_streaming_sessions - TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
ERROR tests/test_streaming_transcription.py::TestStreamingTranscription::test_streaming_with_many_chunks - TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
ERROR tests/test_streaming_transcription.py::TestStreamingTranscription::test_streaming_chunk_order - TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
ERROR tests/test_streaming_transcription.py::TestGPUMemoryManagement::test_continuous_transcription_no_cuda_error - TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
ERROR tests/test_streaming_transcription.py::TestGPUMemoryManagement::test_rapid_transcription_no_resource_leak - TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
ERROR tests/test_streaming_transcription.py::TestErrorHandling::test_streaming_with_failed_chunks - TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
ERROR tests/test_streaming_transcription.py::TestPerformance::test_streaming_reduces_latency - TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
ERROR tests/test_streaming_transcription.py::TestIntegration::test_realistic_voice_input_workflow - TypeError: RefactoredTranscriptionService.stop() got an unexpected keyword argument 'timeout'
========== 17 failed, 74 passed, 40 deselected, 11 errors in 44.25s ===========
